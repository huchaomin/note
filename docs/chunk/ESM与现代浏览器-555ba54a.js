import{r as i,o as n,c as a,f as c,g as s,aa as e,v as o}from"./vendor-b8e3fcbe.js";const u=e("h2",{id:"1-es-modules-are-now-available-in-browsers!-they\u2019re-in",class:"doc-heading"},"ES modules are now available in browsers! They\u2019re in",-1),p=e("ul",null,[e("li",null,"Safari 10.1."),e("li",null,"Chrome 61."),e("li",null,"Firefox 60."),e("li",null,"Edge 16.")],-1),h=e("h2",{id:"2-\u5FC5\u987B\u52A0\u4E0A-type=module",class:"doc-heading"},"\u5FC5\u987B\u52A0\u4E0A type=module",-1),m=e("h2",{id:"3-\u5FC5\u987B\u4F7F\u7528\u76F8\u5BF9\u6216\u7EDD\u5BF9\u8DEF\u5F84\uFF0C\u5E76\u4E14\u5E26\u4E0A\u540E\u7F00",class:"doc-heading"},"\u5FC5\u987B\u4F7F\u7528\u76F8\u5BF9\u6216\u7EDD\u5BF9\u8DEF\u5F84\uFF0C\u5E76\u4E14\u5E26\u4E0A\u540E\u7F00",-1),A=e("div",{class:"doc-note doc-note--warning"},[e("p",{class:"doc-note__title"},"WARNING"),e("p",null,"\u5176\u4ED6\u8BF4\u660E\u7B26\u4FDD\u7559\u4F9B\u5C06\u6765\u4F7F\u7528\uFF0C\u4F8B\u5982\u5BFC\u5165\u5185\u7F6E\u6A21\u5757")],-1),E=e("h2",{id:"4-\u4F7F\u7528-nomodule-\u5411\u540E\u517C\u5BB9",class:"doc-heading"},"\u4F7F\u7528 nomodule \u5411\u540E\u517C\u5BB9",-1),C=e("ul",null,[e("li",null,"Firefox doesn\u2019t support nomodule (issue). Fixed in Firefox nightly!"),e("li",null,"Edge doesn\u2019t support nomodule (issue). Fixed in Edge 16!"),e("li",null,"Safari 10.1 doesn\u2019t support nomodule. Fixed in Safari 11!")],-1),f={class:"doc-note doc-note--tip"},_=e("p",{class:"doc-note__title"},"TIP",-1),y=e("h2",{id:"5-defer-by-default",class:"doc-heading"},"Defer by default",-1),g=e("ul",null,[e("li",null,"The way scripts block the HTML parser during fetching is bad."),e("li",null,"With regular scripts you can use defer to prevent blocking, which also delays script execution until the document has finished parsing, and maintains execution order with other deferred scripts."),e("li",null,"Module scripts behave like defer by default \u2013 there\u2019s no way to make a module script block the HTML parser while it fetches"),e("li",null,"Module scripts use the same execution queue as regular scripts using defer")],-1),D=e("h2",{id:"6-inline-scripts-are-also-deferred",class:"doc-heading"},"Inline scripts are also deferred",-1),b=e("ul",null,[e("li",null,"inline module\u4F1A\u9ED8\u8BA4\u6DFB\u52A0defer\u5C5E\u6027"),e("li",null,"inline script\u4F1A\u5FFD\u89C6defer\u548Casync\u5C5E\u6027")],-1),w=e("h2",{id:"7-async",class:"doc-heading"},"async",-1),x=e("ul",null,[e("li",null,"Async works on external(\u5916\u90E8\u7684) & inline modules"),e("li",null,"\u5982\u679C\u540C\u65F6\u6307defer\u548Casync\uFF0Casync\u4F18\u5148\u4E8E\u73B0\u4EE3\u6D4F\u89C8\u5668\uFF0C\u800C\u652F\u6301defer\u4F46\u4E0D\u652F\u6301async\u7684\u65E7\u7248\u6D4F\u89C8\u5668\u5C06\u56DE\u9000\u5230defer")],-1),j=e("h2",{id:"8-modules-only-execute-once",class:"doc-heading"},"Modules only execute once",-1),B=e("h2",{id:"9-always-cors-\u8DE8\u57DF\u8D44\u6E90\u5171\u4EAB-",class:"doc-heading"},"Always CORS(\u8DE8\u57DF\u8D44\u6E90\u5171\u4EAB)",-1),T=e("p",null,[o("Unlike regular scripts, module scripts (and their imports) are fetched with CORS."),e("br"),o(" This means cross-origin module scripts must return valid CORS headers such as "),e("strong",null,"Access-Control-Allow-Origin: *")],-1),k=e("h2",{id:"10-\u8DE8\u57DF\u8BF7\u6C42\u7684\u51ED\u8BC1",class:"doc-heading"},"\u8DE8\u57DF\u8BF7\u6C42\u7684\u51ED\u8BC1",-1),v=e("p",null,[o("\u5982\u679C\u8BF7\u6C42\u6765\u81EA\u540C\u4E00\u6765\u6E90\uFF0C\u5219\u5927\u591A\u6570\u57FA\u4E8ECORS\u7684API\u90FD\u4F1A\u53D1\u9001\u51ED\u636E\uFF08Cookie\u7B49\uFF09\uFF0C\u4F46\u662Ffetch()\u548C\u6A21\u5757\u811A\u672C\u4F8B\u5916"),e("br"),o(" \u4F46\u662F\u968F\u7740\u6D4F\u89C8\u5668\u7684\u66F4\u65B0\uFF0C\u8FD9\u4E00\u5207\u90FD\u6539\u53D8\u4E86\uFF0C\u73B0\u5728fetch()\u548C\u6A21\u5757\u811A\u672C\u7684\u884C\u4E3A\u4E0E\u5176\u4ED6\u57FA\u4E8ECORS\u7684API\u76F8\u540C")],-1),S=e("h2",{id:"11-mime-\u7C7B\u578B-\u6709\u5F85\u9A8C\u8BC1-",class:"doc-heading"},"mime \u7C7B\u578B(\u6709\u5F85\u9A8C\u8BC1)",-1),F=e("p",null,[o("Unlike regular scripts, modules scripts must be served with one of the valid JavaScript MIME types else they won\u2019t"),e("br"),o(" execute."),e("br"),o(" The HTML Standard recommends "),e("strong",null,"text/javascript")],-1),M=e("h2",{id:"12-\u53C2\u8003\u6587\u732E",class:"doc-heading"},"\u53C2\u8003\u6587\u732E",-1),H={__name:"ESM\u4E0E\u73B0\u4EE3\u6D4F\u89C8\u5668",setup(I){const d=[{id:"doc-title",title:"ES modules"},{id:"1-es-modules-are-now-available-in-browsers!-they\u2019re-in",title:"1. ES modules are now available in browsers! They\u2019re in"},{id:"2-\u5FC5\u987B\u52A0\u4E0A-type=module",title:"2. \u5FC5\u987B\u52A0\u4E0A type=module"},{id:"3-\u5FC5\u987B\u4F7F\u7528\u76F8\u5BF9\u6216\u7EDD\u5BF9\u8DEF\u5F84\uFF0C\u5E76\u4E14\u5E26\u4E0A\u540E\u7F00",title:"3. \u5FC5\u987B\u4F7F\u7528\u76F8\u5BF9\u6216\u7EDD\u5BF9\u8DEF\u5F84\uFF0C\u5E76\u4E14\u5E26\u4E0A\u540E\u7F00"},{id:"4-\u4F7F\u7528-nomodule-\u5411\u540E\u517C\u5BB9",title:"4. \u4F7F\u7528 nomodule \u5411\u540E\u517C\u5BB9"},{id:"5-defer-by-default",title:"5. Defer by default"},{id:"6-inline-scripts-are-also-deferred",title:"6. Inline scripts are also deferred"},{id:"7-async",title:"7. async"},{id:"8-modules-only-execute-once",title:"8. Modules only execute once"},{id:"9-always-cors-\u8DE8\u57DF\u8D44\u6E90\u5171\u4EAB-",title:"9. Always CORS(\u8DE8\u57DF\u8D44\u6E90\u5171\u4EAB)"},{id:"10-\u8DE8\u57DF\u8BF7\u6C42\u7684\u51ED\u8BC1",title:"10. \u8DE8\u57DF\u8BF7\u6C42\u7684\u51ED\u8BC1"},{id:"11-mime-\u7C7B\u578B-\u6709\u5F85\u9A8C\u8BC1-",title:"11. mime \u7C7B\u578B(\u6709\u5F85\u9A8C\u8BC1)"},{id:"12-\u53C2\u8003\u6587\u732E",title:"12. \u53C2\u8003\u6587\u732E"}];return(O,R)=>{const t=i("doc-code"),l=i("doc-link"),r=i("doc-page");return n(),a(r,{desc:"",toc:d},{default:c(()=>[u,p,h,s(t,{code:"//%20utils.mjs%0Aexport%20function%20addTextToBody%28text%29%20%7B%0A%20%20const%20div%20%3D%20document.createElement%28%27div%27%29%0A%20%20div.textContent%20%3D%20text%0A%20%20document.body.appendChild%28div%29%0A%7D%0A",lang:"javascript"}),s(t,{code:"%3Cscript%20type%3D%22module%22%3E%0A%20%20import%20%7BaddTextToBody%7D%20from%20%27./utils.mjs%27%0A%20%20addTextToBody%28%27Modules%20are%20pretty%20cool.%27%29%0A%3C/script%3E%0A",lang:"html"}),m,s(t,{code:"//%20Supported%3A%0Aimport%20%7Bfoo%7D%20from%20%27https%3A//jakearchibald.com/utils/bar.mjs%27%3B%0Aimport%20%7Bfoo%7D%20from%20%27/utils/bar.mjs%27%3B%0Aimport%20%7Bfoo%7D%20from%20%27./bar.mjs%27%3B%0Aimport%20%7Bfoo%7D%20from%20%27../bar.mjs%27%3B%0A%0A//%20Not%20supported%3A%0Aimport%20%7Bfoo%7D%20from%20%27bar.mjs%27%3B%0Aimport%20%7Bfoo%7D%20from%20%27utils/bar.mjs%27%3B%0A",lang:"javascript"}),A,E,s(t,{code:"%3Cscript%20type%3D%22module%22%20src%3D%22module.mjs%22%3E%3C/script%3E%20%20%3C%21--%20%u73B0%u4EE3%u6D4F%u89C8%u5668%20--%3E%0A%3Cscript%20nomodule%20src%3D%22fallback.js%22%3E%3C/script%3E%20%20%3C%21--%20%u975E%u73B0%u4EE3%u4E14%u652F%u6301nomodule%u5C5E%u6027%u7684%u6D4F%u89C8%u5668%20--%3E%0A",lang:"html"}),C,e("div",f,[_,e("p",null,[o('\u8FD9\u91CC\u5C31\u6709\u5FC5\u8981\u8003\u8651\u652F\u6301type="module"\u4E0D\u652F\u6301nomodule\u7684\u6D4F\u89C8\u5668\uFF0C\u53C2\u7167'),s(l,{to:"https://gist.github.com/samthor/64b114e4a4f539915a95b91ffd340acc"},{default:c(()=>[o("https://gist.github.com/samthor/64b114e4a4f539915a95b91ffd340acc")]),_:1})])]),y,s(t,{code:"%3Cscript%20type%3D%22module%22%20src%3D%221.mjs%22%3E%3C/script%3E%0A%3Cscript%20src%3D%222.js%22%3E%3C/script%3E%0A%3Cscript%20defer%20src%3D%223.js%22%3E%3C/script%3E%0A%3C%21--%u6700%u7EC8%u987A%u5E8F%202%20%3E%201%20%3E%203--%3E%0A",lang:"html"}),g,D,s(t,{code:"%3Cscript%20type%3D%22module%22%3E%0A%20%20addTextToBody%28%22Inline%20module%20executed%22%29%3B%0A%3C/script%3E%0A%3Cscript%20src%3D%221.js%22%3E%3C/script%3E%0A%3Cscript%20defer%3E%0A%20%20addTextToBody%28%22Inline%20script%20executed%22%29%3B%0A%3C/script%3E%0A%3Cscript%20defer%20src%3D%222.js%22%3E%3C/script%3E%0A%3C%21--%u6700%u7EC8%u987A%u5E8F%201%20%3E%20inline%20script%20%3E%20inline%20module%20%3E%20defer%20script--%3E%0A",lang:"html"}),b,w,s(t,{code:"%3Cscript%20async%20type%3D%22module%22%3E%0A%20%20import%20%7BaddTextToBody%7D%20from%20%27./utils.mjs%27%0A%20%20addTextToBody%28%27Inline%20module%20executed.%27%29%0A%3C/script%3E%0A%3Cscript%20async%20type%3D%22module%22%20src%3D%221.mjs%22%3E%3C/script%3E%0A",lang:"html"}),x,j,s(t,{code:"%3C%21--%201.mjs%20%u53EA%u6267%u884C%u4E00%u6B21%20--%3E%0A%3Cscript%20type%3D%22module%22%20src%3D%221.mjs%22%3E%3C/script%3E%0A%3Cscript%20type%3D%22module%22%20src%3D%221.mjs%22%3E%3C/script%3E%0A%3Cscript%20type%3D%22module%22%3E%0A%20%20import%20%22./1.mjs%22%3B%0A%3C/script%3E%0A%0A%3C%21--%202.js%20%u6267%u884C%u4E24%u6B21%20--%3E%0A%3Cscript%20src%3D%222.js%22%3E%3C/script%3E%0A%3Cscript%20src%3D%222.js%22%3E%3C/script%3E%0A",lang:"html"}),B,T,s(t,{code:"%3C%21--%20This%20will%20not%20execute%2C%20as%20it%20fails%20a%20CORS%20check%20--%3E%0A%3Cscript%20type%3D%22module%22%20src%3D%22https%3A//%u2026.now.sh/no-cors%22%3E%3C/script%3E%0A%0A%3C%21--%20This%20will%20not%20execute%2C%20as%20one%20of%20its%20imports%20fails%20a%20CORS%20check%20--%3E%0A%3Cscript%20type%3D%22module%22%3E%0A%20%20import%20%27https%3A//%u2026.now.sh/no-cors%27%3B%0A%20%20addTextToBody%28%22This%20will%20not%20execute.%22%29%3B%0A%3C/script%3E%0A%0A%3C%21--%20This%20will%20execute%20as%20it%20passes%20CORS%20checks%20--%3E%0A%3Cscript%20type%3D%22module%22%20src%3D%22https%3A//%u2026.now.sh/cors%22%3E%3C/script%3E%0A",lang:"html"}),k,v,s(t,{code:"%3C%21--%20Fetched%20with%20credentials%20%28cookies%20etc%29%20--%3E%0A%3Cscript%20src%3D%221.js%22%3E%3C/script%3E%0A%0A%3C%21--%20Fetched%20with%20credentials%2C%20except%20in%20old%20browsers%20that%20follow%20the%20old%20spec%20--%3E%0A%3Cscript%20type%3D%22module%22%20src%3D%221.mjs%22%3E%3C/script%3E%0A%0A%3C%21--%20Fetched%20with%20credentials%2C%20in%20browsers%20that%20follow%20the%20old%20%26%20new%20spec%20--%3E%0A%3Cscript%20type%3D%22module%22%20crossorigin%20src%3D%221.mjs%22%3E%3C/script%3E%0A%0A%3C%21--%20Fetched%20without%20credentials%20--%3E%0A%3Cscript%20type%3D%22module%22%20crossorigin%20src%3D%22https%3A//other-origin/1.mjs%22%3E%3C/script%3E%0A%0A%3C%21--%20Fetched%20with%20credentials--%3E%0A%3Cscript%20type%3D%22module%22%20crossorigin%3D%22use-credentials%22%20src%3D%22https%3A//other-origin/1.mjs%22%3E%3C/script%3E%0A",lang:"html"}),S,F,M,e("p",null,[s(l,{to:"[https://jakearchibald.com/2017/es-modules-in-browsers/]"},{default:c(()=>[o("https://jakearchibald.com/2017/es-modules-in-browsers/")]),_:1})])]),_:1})}}};export{H as default};
