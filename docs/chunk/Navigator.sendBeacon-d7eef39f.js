import{r as e,o as c,c as n,f as s,g as r,aa as u}from"./vendor-e1827163.js";const d=u("h2",{id:"1-\u7528\u6237\u79BB\u5F00\u9875\u9762\u65F6\u7684\u7EDF\u8BA1\u52A8\u4F5C",class:"doc-heading"},"\u7528\u6237\u79BB\u5F00\u9875\u9762\u65F6\u7684\u7EDF\u8BA1\u52A8\u4F5C",-1),i=u("div",{class:"doc-note doc-note--tip"},[u("p",{class:"doc-note__title"},"TIP"),u("p",null,"\u5F53\u6D4F\u89C8\u5668\u7A97\u53E3\u5173\u95ED\u6216\u8005\u5237\u65B0\u65F6\uFF0C\u4F1A\u89E6\u53D1beforeunload\u4E8B\u4EF6")],-1),B={__name:"Navigator.sendBeacon",setup(C){const o=[{id:"doc-title",title:"Navigator.sendBeacon"},{id:"1-\u7528\u6237\u79BB\u5F00\u9875\u9762\u65F6\u7684\u7EDF\u8BA1\u52A8\u4F5C",title:"1. \u7528\u6237\u79BB\u5F00\u9875\u9762\u65F6\u7684\u7EDF\u8BA1\u52A8\u4F5C"}];return(F,A)=>{const t=e("doc-code"),a=e("doc-page");return c(),n(a,{desc:"\u4F7F\u7528Navigator.sendBeacon\u76D1\u542C\u7528\u6237\u79BB\u5F00\u9875\u9762\uFF0C\u5E76\u5411\u540E\u7AEF\u53D1\u9001\u6570\u636E",toc:o},{default:s(()=>[d,r(t,{code:"created%20%28%29%20%7B%0A%20%20//%20%u7528%u6237%u79BB%u5F00%u9875%u9762%u65F6%u91CA%u653E%u9501%0A%20%20window.addEventListener%28%27beforeunload%27%2C%20this.releaseLock%29%0A%7D%2C%0Amethods%3A%20%7B%0A%20%20releaseLock%20%28%29%20%7B%0A%20%20%20%20window.removeEventListener%28%27beforeunload%27%2C%20this.releaseLock%29%0A%20%20%20%20//%20%u8FDB%u5165%u8FD9%u4E2A%u9875%u9762%u4E4B%u524D%u5C31%u62FF%u5230%u4E86%u8FD9%u4E2AiLock%u7684%u503C%uFF0C%u8868%u793A%u9501%u7684%u72B6%u6001%0A%20%20%20%20if%20%28%21this.iLock%29%20return%20//%20%u5982%u679C%u6CA1%u6709%u9501%uFF0C%u5C31%u4E0D%u53BB%u91CA%u653E%u9501%0A%20%20%20%20const%20blob%20%3D%20new%20Blob%28%5BJSON.stringify%28yourData%29%5D%2C%20%7B%20type%3A%20%27application/json%3B%20charset%3DUTF-8%27%20%7D%29%0A%20%20%20%20navigator.sendBeacon%28yourUrl%2C%20blob%29%0A%20%20%7D%2C%0A%7D%0AbeforeRouteLeave%20%28to%2C%20from%2C%20next%29%20%7B%20//%20%u8FD9%u91CC%u6CA1%u6709%u8003%u8651keep-alive%u7684%u60C5%u51B5%0A%20%20//%20%u76F8%u540ClockId%u9875%u9762%u4E4B%u95F4%u4E92%u76F8%u8DF3%u8F6C%u4E0D%u7528%u89E3%u9501%uFF0C%uFF08%u4F1A%u4EA7%u751F%u9501%u8FD8%u6CA1%u89E3%u5B8C%uFF0C%u5C31%u53BB%u62FF%u9501%uFF0C%u62FF%u9501%u5931%u8D25%u7684%u60C5%u51B5%uFF09%0A%20%20const%20arr%20%3D%20%5B//...%5D%20//%20%u76F8%u540ClockId%u9875%u9762%u7684name%u96C6%u5408%0A%20%20if%20%28%21arr.includes%28to.name%29%20%7C%7C%20%21arr.includes%28from.name%29%29%20%7B%0A%20%20%20%20this.releaseLock%28%29%0A%20%20%7D%0A%20%20next%28%29%0A%7D%2C%0A",lang:"javascript"}),i]),_:1})}}};export{B as default};
