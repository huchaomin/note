import{r as e,o as A,c as a,f as s,g as n}from"./vendor-e1827163.js";const d={__name:"index_js",setup(D){const r=[];return(u,i)=>{const t=e("doc-code"),o=e("doc-page");return A(),a(o,{desc:"",toc:r},{default:s(()=>[n(t,{code:"import%20Vue%20from%20%27vue%27%0Aimport%20apis%20from%20%27./apis.js%27%0Aimport%20axios%20from%20%27axios%27%0Aimport%20store%20from%20%27store%27%0Aimport%20router%20from%20%27router%27%0A%0Aimport%20%7B%20resolveURL%20%7D%20from%20%27./url%27%0A%0Aconst%20loadingOption%20%3D%20%7B%0A%20%20lock%3A%20true%2C%0A%20%20target%3A%20%27body%27%2C%0A%20%20background%3A%20%27rgba%280%2C%200%2C%200%2C%200.1%29%27%2C%0A%7D%0A%0Aconst%20http%20%3D%20axios.create%28%7B%0A%20%20timeout%3A%2010000%2C%0A%7D%29%0A%0Ahttp.interceptors.request.use%28config%20%3D%3E%20%7B%0A%20%20const%20tenantId%20%3D%20store.state.tenantId%0A%20%20if%20%28tenantId%29%20%7B%0A%20%20%20%20config.headers.tenantId%20%3D%20tenantId%0A%20%20%7D%0A%20%20if%20%28config.formUrlencoded%29%20%7B%0A%20%20%20%20//%20config.headers%5B%27Content-Type%27%5D%20%3D%20%27application/x-www-form-urlencoded%27%20//%20axios%uFF08%u6216%u6D4F%u89C8%u5668%uFF09%20%u81EA%u52A8%u8BBE%u7F6E%0A%0A%20%20%20%20//%20%u7A7A%u683C%u4F1A%u8F6C%u5316%u6210%20+%uFF0C%u800C%u4E0D%u662F%20%2520%0A%20%20%20%20//%20const%20searchParams%20%3D%20new%20URLSearchParams%28%29%0A%20%20%20%20//%20Object.keys%28config.data%29.forEach%28key%20%3D%3E%20%7B%0A%20%20%20%20//%20%20%20searchParams.set%28key%2C%20config.data%5Bkey%5D%29%0A%20%20%20%20//%20%7D%29%0A%20%20%20%20//%20config.data%20%3D%20searchParams.toString%28%29%0A%0A%20%20%20%20//%20%u7A7A%u683C%u4F1A%u8F6C%u5316%u6210%2520%28%u6216%u8005%u4F7F%u7528qs.stringify%28config.data%29%29%0A%20%20%20%20config.data%20%3D%20Object.keys%28config.data%29.map%28key%20%3D%3E%20%60%24%7Bkey%7D%3D%24%7BencodeURIComponent%28config.data%5Bkey%5D%29%7D%60%29.join%28%27%26%27%29%0A%20%20%20%20delete%20config.formUrlencoded%0A%20%20%7D%0A%20%20return%20config%0A%7D%2C%20error%20%3D%3E%20Promise.reject%28error%29%29%0A%0Afunction%20isGetTenant%20%28url%29%20%7B%0A%20%20return%20url.includes%28apis.getUserInfo.url%29%20%7C%7C%20url.includes%28apis.getUserTenantInfo.url%29%0A%7D%0A%0Ahttp.interceptors.response.use%28response%20%3D%3E%20%7B%0A%20%20const%20data%20%3D%20response.data%0A%20%20if%20%28data.code%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20return%20data.data%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28data.msg%29%20%7B%0A%20%20%20%20%20%20const%20showErrMsg%20%3D%20response.config._showErrMsg%0A%20%20%20%20%20%20if%20%28showErrMsg%20%3D%3D%3D%20undefined%20%7C%7C%20showErrMsg%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20Vue.prototype.%24message.error%28data.msg%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20delete%20response.config._showErrMsg%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28data.code%29%20%7B%0A%20%20%20%20%20%20if%20%28data.code%20%3D%3D%3D%2010212%29%20%7B%20//%20%u6B63%u5728%u7EF4%u62A4%u4E2D%0A%20%20%20%20%20%20%20%20//%20noinspection%20JSIgnoredPromiseFromCall%0A%20%20%20%20%20%20%20%20store.dispatch%28%27updateSystemState%27%29%0A%20%20%20%20%20%20%7D%20else%20if%20%28data.code%20%3D%3D%3D%2010018%29%20%7B%20//%20%u9879%u76EE%u4E0D%u5B58%u5728%0A%20%20%20%20%20%20%20%20if%20%28router.currentRoute.name%20%21%3D%3D%20%27projectList%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20router.push%28%7B%20name%3A%20%27projectList%27%20%7D%29%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20Promise.reject%28response%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20data%20//%20%u6709%u53EF%u80FD%u662FBlob%u5BF9%u8C61%0A%7D%2C%20error%20%3D%3E%20%7B%0A%20%20const%20errMsg%20%3D%20Vue.prototype.%24message.error%0A%20%20if%20%28error.response%29%20%7B%0A%20%20%20%20const%20%7B%20status%20%7D%20%3D%20error.response%0A%20%20%20%20if%20%28status%20%3D%3D%3D%20401%29%20%7B%20//%20%u53BB%20idaas%20%u5E73%u53F0%u767B%u9646%u9274%u6743%0A%20%20%20%20%20%20const%20data%20%3D%20error.response.data.data%0A%20%20%20%20%20%20const%20mark%20%3D%20%27%26redirect%3D%27%0A%20%20%20%20%20%20const%20pre%20%3D%20data.split%28mark%29%5B0%5D%0A%20%20%20%20%20%20window.location.href%20%3D%20%60%24%7Bpre%20+%20mark%20+%20window.location.href%7D%60%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28%21isGetTenant%28error.response.config.url%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28status%20%3D%3D%3D%20403%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20store.commit%28%27setNoPermission%27%2C%20true%29%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28error.msg%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20errMsg%28error.msg%29%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20errMsg%28%27%u7F51%u7EDC%u9519%u8BEF%uFF01%27%29%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28%21isGetTenant%28error.config.url%29%29%20%7B%0A%20%20%20%20%20%20if%20%28error.code%20%3D%3D%3D%20%27ECONNABORTED%27%20%26%26%20error.message.indexOf%28%27timeout%27%29%20%3E%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20errMsg%28%27%u94FE%u63A5%u8D85%u65F6%uFF01%27%29%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20errMsg%28%27%u7F51%u7EDC%u9519%u8BEF%uFF01%27%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20Promise.reject%28error%29%0A%7D%29%0A%0Aconst%20apiCache%20%3D%20new%20Map%28%29%0A%0Aclass%20Ajax%20%7B%0A%20%20constructor%20%28config%29%20%7B%0A%20%20%20%20this.config%20%3D%20Object.assign%28%7B%0A%20%20%20%20%20%20type%3A%20%27get%27%2C%0A%20%20%20%20%20%20cache%3A%20false%2C%0A%20%20%20%20%20%20loading%3A%20false%2C%0A%20%20%20%20%7D%2C%20config%29%0A%20%20%7D%0A%0A%20%20send%20%28data%29%20%7B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20cache%2C%0A%20%20%20%20%20%20loading%2C%0A%20%20%20%20%7D%20%3D%20this.config%0A%20%20%20%20let%20pLoading%0A%20%20%20%20if%20%28data._loading%20%21%3D%3D%20undefined%29%20%7B%0A%20%20%20%20%20%20pLoading%20%3D%20data._loading%0A%20%20%20%20%20%20delete%20data._loading%0A%20%20%20%20%7D%0A%20%20%20%20const%20url%20%3D%20this.handleUrl%28data%29%0A%20%20%20%20const%20fLoading%20%3D%20pLoading%20%3D%3D%3D%20undefined%20%3F%20loading%20%3A%20pLoading%0A%20%20%20%20const%20loadingVm%20%3D%20fLoading%20%3F%20Vue.prototype.%24loading%28loadingOption%29%20%3A%20null%0A%20%20%20%20let%20promise%0A%20%20%20%20const%20cfgs%20%3D%20Object.assign%28%7B%7D%2C%20this.config%29%0A%20%20%20%20delete%20%28cfgs.type%29%0A%20%20%20%20delete%20%28cfgs.url%29%0A%20%20%20%20delete%20%28cfgs.cache%29%0A%20%20%20%20delete%20%28cfgs.loading%29%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%27get%27%29%20%7B%20//%20%u53EA%u7F13%u5B58get%u8BF7%u6C42%0A%20%20%20%20%20%20if%20%28cache%29%20promise%20%3D%20apiCache.get%28url%29%0A%20%20%20%20%20%20if%20%28%21promise%29%20%7B%0A%20%20%20%20%20%20%20%20promise%20%3D%20http.get%28url%2C%20cfgs%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%27post%27%29%20%7B%0A%20%20%20%20%20%20promise%20%3D%20http.post%28url%2C%20data%2C%20cfgs%29%0A%20%20%20%20%7D%20//%20%u5176%u4ED6type%u78B0%u5230%u4E86%u518D%u6DFB%u52A0%0A%20%20%20%20return%20promise.then%28res%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%27get%27%20%26%26%20cache%29%20%7B%0A%20%20%20%20%20%20%20%20apiCache.set%28url%2C%20promise%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20Promise.resolve%28res%29%0A%20%20%20%20%7D%29.catch%28res%20%3D%3E%20Promise.reject%28res%29%29.finally%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28loadingVm%29%20loadingVm.close%28%29%0A%20%20%20%20%7D%29%0A%20%20%7D%0A%0A%20%20handleUrl%20%28data%29%20%7B%0A%20%20%20%20let%20%7B%0A%20%20%20%20%20%20url%2C%0A%20%20%20%20%20%20type%2C%0A%20%20%20%20%7D%20%3D%20this.config%0A%20%20%20%20let%20query%20%3D%20%27%3F%27%0A%20%20%20%20Object.keys%28data%29.forEach%28key%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20reg%20%3D%20new%20RegExp%28%60%5C%5C%24%5C%5C%7B%24%7Bkey%7D%5C%5C%7D%60%2C%20%27g%27%29%0A%20%20%20%20%20%20if%20%28reg.test%28url%29%29%20%7B%0A%20%20%20%20%20%20%20%20url%20%3D%20url.replace%28reg%2C%20encodeURIComponent%28data%5Bkey%5D%29%29%0A%20%20%20%20%20%20%20%20delete%20data%5Bkey%5D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20query%20+%3D%20%60%24%7Bkey%7D%3D%24%7BencodeURIComponent%28data%5Bkey%5D%29%7D%26%60%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%0A%20%20%20%20if%20%28query%20%21%3D%3D%20%27%3F%27%20%26%26%20type%20%3D%3D%3D%20%27get%27%29%20%7B%0A%20%20%20%20%20%20query%20%3D%20query.slice%280%2C%20-1%29%0A%20%20%20%20%20%20url%20+%3D%20query%0A%20%20%20%20%7D%0A%20%20%20%20return%20resolveURL%28url%29%0A%20%20%7D%0A%7D%0A%0Aconst%20%24ajax%20%3D%20%7B%7D%0AObject.keys%28apis%29.forEach%28key%20%3D%3E%20%7B%0A%20%20%24ajax%5Bkey%5D%20%3D%20function%20%28data%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20return%20new%20Ajax%28apis%5Bkey%5D%29.send%28data%29%0A%20%20%7D%0A%7D%29%0AVue.prototype.%24ajax%20%3D%20%24ajax%0Aexport%20default%20%24ajax%0A",lang:"javascript"})]),_:1})}}};export{d as default};
